<div class="bg-black min-h-screen text-white">
    <div class="mx-auto container px-4 py-8 h-full">
        <app-navbar></app-navbar>

        @if (loading()) {
        <div class="min-h-screen bg-black p-10 flex justify-center items-center">
            <!-- Skeleton or simple loader -->
            <div class="animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-red-500"></div>
        </div>
        } @else if (!content()) {
        <div class="bg-black text-white h-screen">
            <div class="max-w-6xl mx-auto">
                <div class="text-center mx-auto px-4 py-8 h-full mt-40">
                    <h2 class="text-2xl sm:text-5xl font-bold text-balance">Content not found ðŸ˜¥</h2>
                </div>
            </div>
        </div>
        } @else {
        <!-- Trailers Navigation -->
        @if (trailers().length > 0) {
        <div class="flex justify-between items-center mb-4">
            <button class="bg-gray-500/70 hover:bg-gray-500 text-white py-2 px-4 rounded"
                [class.opacity-50]="currentTrailerIdx() === 0" [class.cursor-not-allowed]="currentTrailerIdx() === 0"
                [disabled]="currentTrailerIdx() === 0" (click)="handlePrev()">
                <lucide-icon name="chevron-left" [size]="24"></lucide-icon>
            </button>

            <button class="bg-gray-500/70 hover:bg-gray-500 text-white py-2 px-4 rounded"
                [class.opacity-50]="currentTrailerIdx() === trailers().length - 1"
                [class.cursor-not-allowed]="currentTrailerIdx() === trailers().length - 1"
                [disabled]="currentTrailerIdx() === trailers().length - 1" (click)="handleNext()">
                <lucide-icon name="chevron-right" [size]="24"></lucide-icon>
            </button>
        </div>
        }

        <!-- Video Player -->
        <div class="aspect-video mb-8 p-2 sm:px-10 md:px-32">
            @if (trailers().length > 0) {
            <iframe [src]="getSafeUrl(trailers()[currentTrailerIdx()].key)"
                class="w-full h-full rounded-lg overflow-hidden" frameborder="0" allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
            </iframe>
            } @else {
            <h2 class="text-xl text-center mt-5">
                No trailers available for
                <span class="font-bold text-red-600">{{ content()?.title || content()?.name }}</span> ðŸ˜¥
            </h2>
            }
        </div>

        <!-- Details -->
        <div class="flex flex-col md:flex-row items-center justify-between gap-20 max-w-6xl mx-auto">
            <div class="mb-4 md:mb-0">
                <h2 class="text-5xl font-bold text-balance">{{ content()?.title || content()?.name }}</h2>

                <p class="mt-2 text-lg">
                    {{ (content()?.release_date || content()?.first_air_date) | date:'longDate' }}
                    |
                    @if (content()?.adult) {
                    <span class="text-red-600">18+</span>
                    } @else {
                    <span class="text-green-600">PG-13</span>
                    }
                </p>
                <p class="mt-4 text-lg">{{ content()?.overview }}</p>
            </div>
            <img [src]="ORIGINAL_IMG_BASE_URL + content()?.poster_path" alt="Poster image"
                class="max-h-[600px] rounded-md" />
        </div>

        <!-- Similar Content -->
        @if (similarContent().length > 0) {
        <div class="mt-12 max-w-5xl mx-auto relative">
            <h3 class="text-3xl font-bold mb-4">Similar Movies/Tv Show</h3>

            <div class="flex overflow-x-scroll scrollbar-hide gap-4 pb-4 group" #sliderRef>
                @for (item of similarContent(); track item.id) {
                @if (item.poster_path) {
                <a [routerLink]="['/watch', item.id]" class="w-52 flex-none">
                    <img [src]="SMALL_IMG_BASE_URL + item.poster_path" alt="Poster path"
                        class="w-full h-auto rounded-md" />
                    <h4 class="mt-2 text-lg font-semibold">{{ item.title || item.name }}</h4>
                </a>
                }
                }
            </div>

            <lucide-icon name="chevron-right"
                class="absolute top-1/2 -translate-y-1/2 right-2 w-8 h-8 opacity-0 group-hover:opacity-100 transition-all duration-300 cursor-pointer bg-red-600 text-white rounded-full"
                (click)="scrollRight()">
            </lucide-icon>

            <lucide-icon name="chevron-left"
                class="absolute top-1/2 -translate-y-1/2 left-2 w-8 h-8 opacity-0 group-hover:opacity-100 transition-all duration-300 cursor-pointer bg-red-600 text-white rounded-full"
                (click)="scrollLeft()">
            </lucide-icon>
        </div>
        }
        }
    </div>
</div>